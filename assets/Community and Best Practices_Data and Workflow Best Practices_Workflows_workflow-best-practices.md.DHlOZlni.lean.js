import{_ as s,c as a,a7 as e,o as t}from"./chunks/framework.BKiDQeMP.js";const c=JSON.parse('{"title":"Best Practices Guidelines","description":"","frontmatter":{"order":1},"headers":[],"relativePath":"Community and Best Practices/Data and Workflow Best Practices/Workflows/workflow-best-practices.md","filePath":"Community and Best Practices/Data and Workflow Best Practices/Workflows/workflow-best-practices.md"}'),n={name:"Community and Best Practices/Data and Workflow Best Practices/Workflows/workflow-best-practices.md"};function l(h,i,o,r,p,k){return t(),a("div",null,i[0]||(i[0]=[e(`<h1 id="best-practices-guidelines" tabindex="-1">Best Practices Guidelines <a class="header-anchor" href="#best-practices-guidelines" aria-label="Permalink to &quot;Best Practices Guidelines&quot;">​</a></h1><p>Before writing any code, taking a few moments to structure your project thoughtfully can significantly improve its clarity, maintainability, and reproducibility. This section covers the foundational steps for organizing your workflow repository, managing dependencies, and using version control effectively from the start. These practices make it easier for collaborators (and your future self) to understand, run, and build upon your work.</p><h2 id="structure-your-project-logically" tabindex="-1">Structure Your Project Logically <a class="header-anchor" href="#structure-your-project-logically" aria-label="Permalink to &quot;Structure Your Project Logically&quot;">​</a></h2><p>A well-organized project directory makes your workflow easier for others (and yourself) to navigate and understand. Adopting a consistent, standard structure is highly recommended.</p><p>Consider using separate directories for distinct components of your project:</p><ul><li><code>code/</code> or <code>src/</code>: For primary source code files, including scripts (<code>.py</code>) and notebooks (<code>.ipynb</code>).</li><li><code>data/</code>: For input data files. Note that large data files should generally not be committed to version control (see next section). This directory might contain small sample datasets or scripts to download larger inputs.</li><li><code>docs/</code>: For detailed documentation, figures, or reports.</li><li><code>environment/</code>: For files defining the software environment (e.g., <code>environment.yml</code>, <code>Dockerfile</code>).</li></ul><p>At the root level of your project, always include a <code>README.md</code> file. This file serves as the entry point and should clearly explain:</p><ul><li>The purpose of the project and workflow.</li><li>The contents of the repository and the directory structure.</li><li>Instructions on how to set up the environment and run the workflow.</li><li>Information about required input data and how to obtain it.</li></ul><h2 id="use-version-control-effectively" tabindex="-1">Use Version Control Effectively <a class="header-anchor" href="#use-version-control-effectively" aria-label="Permalink to &quot;Use Version Control Effectively&quot;">​</a></h2><p>Using a version control system like Git is essential for managing your workflow&#39;s development, ensuring reproducibility, and enabling collaboration. EarthCODE requires all published workflows to be stored in a Git repository, typically hosted on a platform like GitHub. It&#39;s best practice to start using version control from the very beginning of your project.</p><p>At the start of every project, initialize the repository in github.com, and connect with your project</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;# my project&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> README.md</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> init</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> add</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> README.md</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> commit</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -m</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;first commit&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> branch</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -M</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> main</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> remote</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> add</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> origin</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> {Your</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Repository.git}</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> push</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> origin</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> main</span></span></code></pre></div><p>Version control provides several key benefits:</p><ul><li>It acts as a complete history log, allowing you to track every change and revert to previous versions if needed.</li><li>It facilitates collaboration by allowing multiple people to work on the same codebase simultaneously using branches and merging.</li><li>It serves as a reliable backup mechanism for your code and project history.</li><li>Crucially, it allows you to link specific versions of your code (via commits or tags) to the results generated, which is fundamental for reproducibility.</li></ul><p>When setting up your repository, carefully consider what should and should not be tracked, following common recommendations:</p><ul><li><p>Track These:</p><ul><li>Source code files (.ipynb, .py).</li><li>Configuration files.</li><li>Environment definition files (environment.yml, requirements.txt, Dockerfile).</li><li>Documentation files (README.md, other .md or text files).</li></ul></li><li><p>Do Not Track These:</p><ul><li>Large data files. Data should be stored separately and accessed via links or download scripts.</li><li>Credentials, API keys, or any sensitive information (secrets).</li><li>Generated outputs like plots, figures, or intermediate/final data files.</li></ul></li></ul><p>Use a <code>.gitignore</code> file to explicitly tell Git which files and directories to ignore. To use version control effectively:</p><ul><li>Make frequent, small commits. Each commit should represent a single logical change.</li><li>Write clear and meaningful commit messages that explain why a change was made, not just what was changed.</li><li>Use branches to develop new features, fix bugs, or experiment without affecting the main working version of your code.</li></ul><h2 id="explicitly-define-the-environment" tabindex="-1">Explicitly Define the Environment <a class="header-anchor" href="#explicitly-define-the-environment" aria-label="Permalink to &quot;Explicitly Define the Environment&quot;">​</a></h2><p>For your workflow to be reproducible by others, you must clearly define its software environment. This ensures anyone running your code uses the exact same versions of the necessary libraries.</p><p>The recommended method for many scientific Python workflows is to use Conda and define the environment in an <code>environment.yml</code> file. This file lists all required packages and the channels to get them from.</p><p>To ensure reproducibility, it&#39;s crucial to specify exact versions for your key dependencies (e.g., <code>python=3.10</code>, <code>xarray=2023.10.1</code>). Software libraries change over time, and only by pinning versions can you guarantee your code will run the same way in the future.</p><p>You can generate an <code>environment.yml</code> file that captures the packages you explicitly installed in your current active Conda environment using the following command in your terminal:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">conda</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> env</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> export</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --from-history</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> environment.yml</span></span></code></pre></div><p>This command looks at the history of packages you manually installed (rather than every single dependency) and creates the environment.yml file with specific versions for those primary packages. This approach often provides a good balance between reproducibility and flexibility. Using conda env export without the --from-history flag will pin every package, including all transitive dependencies, which guarantees identical environments but can sometimes make the environment harder to recreate on different operating systems or over long periods.</p><p>While Conda is common, you can also use a requirements.txt file with pip (often generated using pip freeze &gt; requirements.txt) or define a complete environment using a Dockerfile. Whichever method you choose, the file defining the environment must be included in your Git repository.</p><hr><h1 id="writing-clear-and-robust-code" tabindex="-1">Writing Clear and Robust Code <a class="header-anchor" href="#writing-clear-and-robust-code" aria-label="Permalink to &quot;Writing Clear and Robust Code&quot;">​</a></h1><p>Writing clear and robust code is fundamental to achieving <strong>reproducibility</strong>, which is the first pillar of trustworthy scientific analysis. If others (or your future self) cannot re-run the same code with the same data and obtain the same results, the analysis has limited value. This section covers best practices that ensure your code is not only functional but also transparent, maintainable, and reliable enough to guarantee reproducibility.</p><p>By focusing on clarity, modularity, and consistency during the coding phase, you make it easier for colleagues to verify your implementation, build upon your methods, and trust your findings. Reproducibility relies on making both the methodology and its implementation understandable and executable.</p><h2 id="tell-a-story-in-notebooks" tabindex="-1">Tell a Story (in Notebooks) <a class="header-anchor" href="#tell-a-story-in-notebooks" aria-label="Permalink to &quot;Tell a Story (in Notebooks)&quot;">​</a></h2><p>Your workflow, especially when developed in a notebook environment like Jupyter, should be more than just a sequence of code cells; it should be a computational narrative. Use Markdown cells extensively to explain the scientific story you are investigating.</p><p>Start by clearly stating the goal of the analysis, the data being used, and the context of the research in introductory Markdown cells. A good introduction sets the stage for the entire analysis. Consider including metadata like title, authors, date, and keywords, along with a clear description of the context, methodology, and data sources. The example below (taken from the <a href="https://esa-earthcode.github.io/tutorials/pangeo-on-earthcode/#context" target="_blank" rel="noreferrer">EarthCODE Pangeo guide</a>) demonstrates this</p><div class="language-markdown vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">markdown</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-light-font-weight:bold;--shiki-dark:#79B8FF;--shiki-dark-font-weight:bold;">---</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">title: Pangeo X EarthCODE - Burn Severity Mapping</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">subtitle: Example showing how to access EarthCODE OSC data and Sentinel-2 to map wildfire burn severity using Pangeo tools on EDC.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">authors:</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> name: Deyan Samardzhiev</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    orcid: 0009-0003-3803-8522</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    affiliations: Lampata UK</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">date: 2025-06-01</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">keywords: [&quot;earthcode&quot;, &quot;pangeo&quot;, &quot;stac&quot;, &quot;xarray&quot;, &quot;wildfire&quot;, &quot;burn severity&quot;, &quot;sentinel-2&quot;, &quot;nbr&quot;]</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-light-font-weight:bold;--shiki-dark:#79B8FF;--shiki-dark-font-weight:bold;">---</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-light-font-weight:bold;--shiki-dark:#79B8FF;--shiki-dark-font-weight:bold;">## Context</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">This notebook demonstrates how to use the Pangeo open-source software stack within the Euro Data Cube (EDC) platform to analyze wildfire impacts. We will fetch data published on the EarthCODE Open Science Catalog and combine it with publicly available Sentinel-2 imagery to generate burn severity maps.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-light-font-weight:bold;--shiki-dark:#79B8FF;--shiki-dark-font-weight:bold;">### Methodology Approach</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">1.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  Analyze the SeasFire Data Cube to identify potential burnt areas and select a specific event.</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">2.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  Access Sentinel-2 L2A cloud-optimized data for the selected area and time period using a STAC API.</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">3.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  Compute the Normalized Burn Ratio (NBR) index before and after the fire event.</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">4.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  Calculate the difference NBR (dNBR) to highlight burned areas and classify burn severity.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-light-font-weight:bold;--shiki-dark:#79B8FF;--shiki-dark-font-weight:bold;">### Highlights</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Utilizes data directly from the EarthCODE Open Science Catalog (OSC).</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Applies the NBR index, which leverages near-infrared (NIR) and shortwave-infrared (SWIR) wavelengths sensitive to burn scars.</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Demonstrates accessing cloud-optimized Sentinel-2 data via STAC.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-light-font-weight:bold;--shiki-dark:#79B8FF;--shiki-dark-font-weight:bold;">## Data</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">*</span><span style="--shiki-light:#24292E;--shiki-light-font-weight:bold;--shiki-dark:#E1E4E8;--shiki-dark-font-weight:bold;"> **Sentinel-2 L2A COGs:**</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Accessed via the [</span><span style="--shiki-light:#032F62;--shiki-light-text-decoration:underline;--shiki-dark:#DBEDFF;--shiki-dark-text-decoration:underline;">Element 84 Earth Search STAC API</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">](</span><span style="--shiki-light:#24292E;--shiki-light-text-decoration:underline;--shiki-dark:#E1E4E8;--shiki-dark-text-decoration:underline;">https://element84.com/earth-search/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">). Cloud-optimized GeoTIFFs available on AWS S3.</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">*</span><span style="--shiki-light:#24292E;--shiki-light-font-weight:bold;--shiki-dark:#E1E4E8;--shiki-dark-font-weight:bold;"> **SeasFire Data Cube:**</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> A global dataset for seasonal fire modeling, accessed via its [</span><span style="--shiki-light:#032F62;--shiki-light-text-decoration:underline;--shiki-dark:#DBEDFF;--shiki-dark-text-decoration:underline;">EarthCODE OSC Product Page</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">](</span><span style="--shiki-light:#24292E;--shiki-light-text-decoration:underline;--shiki-dark:#E1E4E8;--shiki-dark-text-decoration:underline;">https://opensciencedata.esa.int/products/seasfire-cube/collection</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-light-font-weight:bold;--shiki-dark:#79B8FF;--shiki-dark-font-weight:bold;">#### Related Publications &amp; Resources</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">*</span><span style="--shiki-light:#24292E;--shiki-light-font-style:italic;--shiki-dark:#E1E4E8;--shiki-dark-font-style:italic;"> *SeasFire Cube dataset description:*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#032F62;--shiki-light-text-decoration:underline;--shiki-dark:#DBEDFF;--shiki-dark-text-decoration:underline;">https://doi.org/10.5281/zenodo.7246111</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">](</span><span style="--shiki-light:#24292E;--shiki-light-text-decoration:underline;--shiki-dark:#E1E4E8;--shiki-dark-text-decoration:underline;">https://doi.org/10.5281/zenodo.7246111</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">*</span><span style="--shiki-light:#24292E;--shiki-light-font-style:italic;--shiki-dark:#E1E4E8;--shiki-dark-font-style:italic;"> *Sentinel-2 Cloud-Optimized GeoTIFFs:*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#032F62;--shiki-light-text-decoration:underline;--shiki-dark:#DBEDFF;--shiki-dark-text-decoration:underline;">https://registry.opendata.aws/sentinel-2-l2a-cogs/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">](</span><span style="--shiki-light:#24292E;--shiki-light-text-decoration:underline;--shiki-dark:#E1E4E8;--shiki-dark-text-decoration:underline;">https://registry.opendata.aws/sentinel-2-l2a-cogs/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">*</span><span style="--shiki-light:#24292E;--shiki-light-font-style:italic;--shiki-dark:#E1E4E8;--shiki-dark-font-style:italic;"> *Example NBR calculation notebook:*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [Link to relevant notebook or paper]</span></span></code></pre></div><p>For each significant code cell or block of cells, add Markdown explanations before the code. Don&#39;t just describe what the code does (e.g., &quot;load the data&quot;); explain why this step is necessary and how it fits into the overall analysis (e.g., &quot;Load the Sentinel-2 L2A data for the region of interest to calculate vegetation indices&quot;). Describe the reasoning behind parameter choices or specific methods used. Consider who your audience is – including your future self – and adjust the level of detail accordingly. For instance:</p><div class="language-markdown vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">markdown</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-light-font-weight:bold;--shiki-dark:#79B8FF;--shiki-dark-font-weight:bold;">## Load and Preprocess Data</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">First, we load the SST dataset using xarray. We select the North Atlantic region (defined by latitude and longitude bounds) and the time period (1990-2020). We then calculate the monthly anomalies by subtracting the climatological mean for each month to remove the seasonal cycle, which helps in isolating the long-term trend.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-light-font-weight:bold;--shiki-dark:#79B8FF;--shiki-dark-font-weight:bold;"># Code cell to load data, select region/time, calculate anomalies</span></span></code></pre></div><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sst_data </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> xr.open_dataset(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">regional_data </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sst_data.sel(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">anomalies </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> regional_data.groupby(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;time.month&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> regional_data.groupby(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;time.month&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).mean(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">dim</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;time&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>It&#39;s equally important to interpret intermediate and final results within Markdown cells. Explain what a plot shows or what a calculated value means in the context of your scientific question.</p><div class="language-markdown vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">markdown</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-light-font-weight:bold;--shiki-dark:#79B8FF;--shiki-dark-font-weight:bold;">## Visualize the Trend</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">The map below shows the calculated linear trend in SST anomalies (C per decade) for each grid cell. Positive values (reds) indicate warming trends, while negative values (blues) indicate cooling. We observe significant warming across most of the North Atlantic basin.</span></span></code></pre></div><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Code cell to calculate trend and create a map plot</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">trend </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> anomalies.polyfit(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">dim</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;time&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">deg</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">trend_map </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> trend.polyfit_coefficients.sel(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">degree</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 12</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # Convert to degC/decade</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">trend_map.plot()</span></span></code></pre></div><p>Think of the notebook as a story with a beginning (introduction, setup), a middle (data processing, analysis steps), and an end (results, interpretation, conclusion). Make a habit of adding this narrative text as you develop the analysis, rather than waiting until the end. If you don&#39;t have time for full explanations during interactive exploration, leave short notes for yourself to expand on later. This ongoing documentation ensures that the reasoning behind the code is captured, making the entire workflow transparent and truly understandable.</p><h2 id="modularize-and-refactor-code" tabindex="-1">Modularize and Refactor Code <a class="header-anchor" href="#modularize-and-refactor-code" aria-label="Permalink to &quot;Modularize and Refactor Code&quot;">​</a></h2><p>Avoid duplicating code within your notebooks. It&#39;s common during interactive analysis to copy a cell, tweak a few lines, and run it again. While quick, this makes your workflow hard to read, debug, and maintain. If you find yourself copying and pasting code, take the time to refactor it.</p><h3 id="turn-repeated-code-into-functions" tabindex="-1">Turn Repeated Code into Functions <a class="header-anchor" href="#turn-repeated-code-into-functions" aria-label="Permalink to &quot;Turn Repeated Code into Functions&quot;">​</a></h3><p>If you use the same or very similar block of code multiple times, encapsulate it in a function. Define the function in one cell and then call it wherever needed. This makes your notebook shorter, easier to understand, and much simpler to update if you need to fix a bug or change the logic.</p><p>For example, instead of repeating plotting code:</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Cell 1: Plot temperature</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">plt.figure(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">figsize</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">temperature_data.plot()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">plt.title(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Temperature Over Time&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">plt.xlabel(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Date&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">plt.ylabel(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Temperature (C)&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">plt.grid(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">True</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">plt.show()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Cell 5: Plot precipitation (similar plotting code)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">plt.figure(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">figsize</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">precipitation_data.plot()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">plt.title(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Precipitation Over Time&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">plt.xlabel(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Date&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">plt.ylabel(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Precipitation (mm)&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">plt.grid(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">True</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">plt.show()</span></span></code></pre></div><p>Define a function:</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Define plotting function in one cell</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> matplotlib.pyplot </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> plt</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> plot_timeseries</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(data, title, ylabel):</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;&quot;&quot;Helper function to plot time series data.&quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    plt.figure(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">figsize</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    data.plot()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    plt.title(title)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    plt.xlabel(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Date&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    plt.ylabel(ylabel)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    plt.grid(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">True</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    plt.show()</span></span></code></pre></div><p>Then call it:</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Cell 1: Call function for temperature</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">plot_timeseries(temperature_data, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Temperature Over Time&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Temperature (C)&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Cell 5: Call function for precipitation</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">plot_timeseries(precipitation_data, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Precipitation Over Time&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Precipitation (mm)&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>If a function becomes complex or if you plan to reuse it across multiple notebooks or projects, consider moving it into a separate Python script (a .py file) within your code/ or src/ directory. You can then import this function into your notebook just like any other library. This keeps your notebooks focused on the analysis flow and makes your core logic easier to test and reuse.</p><p>For example, create a file my_utils.py:</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># my_utils.py</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> xarray </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> xr</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> calculate_anomaly</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(data):</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;&quot;&quot;Calculates monthly anomalies.&quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    climatology </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> data.groupby(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;time.month&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).mean(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">dim</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;time&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    anomalies </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> data.groupby(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;time.month&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> climatology</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> anomalies</span></span></code></pre></div><p>Then, in your notebook:</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Notebook cell</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> my_utils </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> calculate_anomaly</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Load data</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sst_data </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> xr.open_dataset(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Use the imported function</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">anomalies </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> calculate_anomaly(sst_data[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;sst&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">anomalies.plot()</span></span></code></pre></div><p>Refactoring code into functions and modules not only improves readability and maintainability but also makes it easier to add interactivity, for example, by connecting widgets to functions to explore different parameters. Continuously look for opportunities to refactor and simplify your code as you develop the workflow.</p><h2 id="adopt-a-consistent-coding-style" tabindex="-1">Adopt a Consistent Coding Style <a class="header-anchor" href="#adopt-a-consistent-coding-style" aria-label="Permalink to &quot;Adopt a Consistent Coding Style&quot;">​</a></h2><p>Writing code that follows a consistent style makes it much easier for others (and your future self) to read, understand, and debug. Clean, predictable code is less prone to errors and simpler to maintain and reuse.</p><p>For Python code, the universally accepted standard is <strong>PEP 8</strong>. Adhering to PEP 8 guidelines for things like indentation, line length, naming conventions, and whitespace makes your code look professional and consistent with the broader Python community.</p><p>Choose descriptive names for your variables, functions, and classes. Avoid short, cryptic names like <code>x</code>, <code>df2</code>, or <code>temp_calc</code>. Instead, use names that clearly indicate the purpose or content.</p><p>Compare:</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Less clear</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">t </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> data.temperature</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">a </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> t.groupby(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;time.month&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).mean()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">d </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> t.groupby(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;time.month&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> a</span></span></code></pre></div><p>To:</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Clearer</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">temperature </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> data.temperature</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">monthly_climatology </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> temperature.groupby(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;time.month&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).mean()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">temperature_anomaly </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> temperature.groupby(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;time.month&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> monthly_climatology</span></span></code></pre></div><p>Longer, descriptive names significantly improve readability.</p><p>Use comments (#) wisely to explain why you are doing something or to clarify complex logic, not to state the obvious. Good comments explain the intent behind the code.</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Less useful comment</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Calculate the mean</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">mean_value </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> data.mean()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># More useful comment</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Calculate the overall mean temperature, excluding NaN values, to establish a baseline</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">mean_value </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> data.mean(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">skipna</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">True</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Also, use docstrings (&quot;&quot;&quot;Docstring goes here&quot;&quot;&quot;) inside your functions to explain what they do, their parameters, and what they return.</p><p>Consider using tools like <code>flake8</code> (a linter) to automatically check your code for PEP 8 compliance and potential errors. Formatters like black can automatically reformat your code to enforce a consistent style. Integrating these tools into your development process helps maintain high code quality with minimal effort.</p><h2 id="build-a-reproducible-analytical-pipeline" tabindex="-1">Build a Reproducible Analytical Pipeline <a class="header-anchor" href="#build-a-reproducible-analytical-pipeline" aria-label="Permalink to &quot;Build a Reproducible Analytical Pipeline&quot;">​</a></h2><p>A key goal for a reproducible workflow is designing it to run automatically from start to finish without needing manual steps. While notebooks are great for interactive work, the final version should be robust enough for non-interactive execution.</p><p>Avoid hardcoding parameters like cloud data access endpoints, dataset identifiers, date ranges, or model settings directly within your analysis code. Instead, make these configurable from outside the workflow. The recommended way to do this is through <strong>environment variables</strong>. Your code should read these variables at runtime, allowing the same workflow code to be executed with different settings simply by changing the environment it runs in.</p><p>Provide sensible default values in your code in case an environment variable is not set. In Python, you can use <code>os.environ.get()</code>:</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> os</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">STAC_API_ENDPOINT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> os.environ.get(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;STAC_API_ENDPOINT&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;[https://earth-search.aws.element84.com/v1](https://earth-search.aws.element84.com/v1)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">SENTINEL2_COLLECTION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> os.environ.get(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;SENTINEL2_COLLECTION&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;sentinel-2-l2a&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">CLOUD_COVER_LIMIT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(os.environ.get(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;CLOUD_COVER_LIMIT&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">OUTPUT_DIR</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> os.environ.get(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;OUTPUT_DIR&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;results/&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Using STAC Endpoint: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{STAC_API_ENDPOINT}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ... print other configuration values ...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ... rest of the analysis code follows, using these variables</span></span></code></pre></div><p>When publishing an EarthCODE Experiment, the specific values used for these environment variables during a run are captured in the Experiment&#39;s Configuration metadata. This links the generic Workflow code to the specific settings that produced a given Product.</p><p>Your entire analysis must run correctly when executed sequentially from the first cell to the last. Interactive development sometimes hides issues where cells rely on being run in a different order. Get into the habit of frequently testing if your notebook runs cleanly from scratch. In Jupyter, use the &quot;Restart Kernel and Run All Cells&quot; command regularly. If it completes without errors, your workflow is likely reproducible. Catching issues this way early saves a lot of debugging time later.</p><p>Once your notebook runs reliably, think about making it even more reusable with parameterization tools. Libraries like papermill let you execute a notebook like a script, passing in different configuration values each time without editing the notebook code itself. For instance, you could run the same analysis notebook for different regions or time periods by just changing the parameters when you run it from the command line. This turns your notebook into a flexible, automated pipeline component, ready for larger computational tasks or integration with testing frameworks.</p><h2 id="implement-basic-testing" tabindex="-1">Implement Basic Testing <a class="header-anchor" href="#implement-basic-testing" aria-label="Permalink to &quot;Implement Basic Testing&quot;">​</a></h2><p>Adding checks to your code helps ensure it behaves as expected and increases confidence in your results. Even simple tests can catch errors early, saving significant debugging time later.</p><p>A straightforward way to add checks directly within your notebook is using <code>assert</code> statements. These statements test whether a condition is true; if it&#39;s false, the code will stop and raise an error, immediately alerting you to a problem. Use them to verify assumptions about your data or the results of calculations.</p><p>For example, after loading data, you might assert that it has the expected dimensions or that key variables exist:</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> xarray </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> xr</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Load data</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dataset </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> xr.open_dataset(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;your_data.nc&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Check if the &#39;temperature&#39; variable exists</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">assert</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;temperature&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dataset.variables, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Temperature variable not found in dataset!&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Check if the time dimension has the expected length</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">assert</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(dataset[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;time&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 120</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Expected 120 time steps, found </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(dataset[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;time&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Check if temperature values are within a plausible range (e.g., Kelvin)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">assert</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dataset[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;temperature&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">].min() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Temperature values seem implausibly low (below 0K)&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">assert</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dataset[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;temperature&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">].max() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 400</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Temperature values seem implausibly high (above 400K)&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ... proceed with analysis ...</span></span></code></pre></div><p>If you have modularized parts of your code into separate Python scripts (.py files), consider writing basic unit tests. Frameworks like pytest allow you to create specific tests for your functions, ensuring they produce correct outputs for given inputs. While extensive testing might not always be feasible, even a few simple tests for critical functions can significantly improve the reliability of your workflow.</p><p>Implementing these basic checks makes your workflow more robust and increases the trustworthiness of your published results.</p><h2 id="ensure-executability" tabindex="-1">Ensure Executability <a class="header-anchor" href="#ensure-executability" aria-label="Permalink to &quot;Ensure Executability&quot;">​</a></h2><p>A core goal of these best practices is to ensure that others can reliably execute your workflow. Merely sharing code and an environment file is a good start, but packaging them together into a formal, self-contained unit provides the highest level of reproducibility and interoperability across different EarthCODE platforms. Ideally, if you start developing on an EarthCODE platform from the start, most of this packaging will be handled for you automatically via the integrated platform FAIR tooling.</p><p>This involves creating an artifact that bundles your version-controlled code, the explicitly defined software environment, and potentially small input files or configuration needed to run. Common and recommended packaging for EarthCODE is using:</p><ol><li><p><strong>Container Images (e.g., Docker):</strong> This is a highly recommended approach. A <code>Dockerfile</code> defines how to build an image containing the operating system, all necessary libraries (often installed via the <code>environment.yml</code>), and your workflow code. This creates a portable, consistent environment that runs identically everywhere, eliminating &quot;works on my machine&quot; issues. Integrated platforms in EarthCODE often directly support running workflows packaged as container images.</p></li><li><p><strong>OGC Application Packages:</strong> This standard defines a way to package applications (including workflows) along with their metadata for execution by services compliant with OGC API - Processes. An Application Package typically includes the code, a description of its execution environment (which might reference a container image), and metadata describing inputs, outputs, and execution parameters. This is particularly relevant for workflows intended to be run as automated processing services within the EarthCODE ecosystem.</p></li></ol><p>Creating these formal packages ensures that your workflow is not just theoretically reproducible but practically executable by others and by automated pipelines on EarthCODE integrated platforms.</p><h2 id="link-code-version-to-results" tabindex="-1">Link Code Version to Results <a class="header-anchor" href="#link-code-version-to-results" aria-label="Permalink to &quot;Link Code Version to Results&quot;">​</a></h2><p>A crucial step for ensuring true reproducibility is explicitly connecting the specific version of your workflow code used to generate a particular data product. Simply publishing the code and the data separately isn&#39;t enough; you need to record exactly which code commit produced which result.</p><p>In EarthCODE, this vital link is captured within the <strong>Experiment</strong> metadata record. When you publish a data <strong>Product</strong>, its metadata should reference the <strong>Workflow</strong> that created it and the details of the code run are in the metadata of an <strong>Experiment</strong>. The Experiment record, in turn, contains precise references to:</p><ul><li>The specific <strong>Workflow</strong> version used (e.g., a Git commit hash or tag).</li><li>The exact <strong>Input Data</strong> consumed.</li><li>The <strong>Configuration</strong> parameters applied during that run.</li></ul><p>This creates a complete, traceable chain from the final data product back to the exact code and conditions that generated it. By formally linking the code version to the results via an Experiment, you provide the necessary provenance for others to verify your findings and confidently reproduce your work.</p>`,95)]))}const g=s(n,[["render",l]]);export{c as __pageData,g as default};
